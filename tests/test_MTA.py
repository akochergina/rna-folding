
import sys
import os

parent_dir = os.path.abspath(os.path.join(os.getcwd()))
sys.path.append(parent_dir)

from modules.MTA import *


test=["-(((-...-)))",".(((-...-)))","-((((...))))"]
for struc in test:
    print(parse_RNA_structure(struc))
print(paired_acc((5,9),test, 1))
print(unpaired_acc(7,test))


def test_class_example():
    result=MTA (["-GCC-AAA-GGC","GGGC-AUU-GCC", "-ACGGAAUCCGU"],1)
    assert result==(".((((...))))"), f"Expected .((((...))))  but got {result}"
    return "Class test passed"

#test_class_example()


"""

test=["GCAGUCGUGGCCGAGU---GGUUAAGGCGUCUGACUCGAAAUCAGAUUCCCUCUGGGAGCGUAGGUUCGAAUCCUACCGGCUGCG",
"GCGGGGGUGCCCGAGCCUGGCCAAAGGGGUCGGGCUCAGGACCCGAUGGCGUAGGCCUGCGUGGGUUCAAAUCCCACCCCCCGCA",
"UGGAGUAUAGCCAAG--UGG--UAAGGCAUCGGUUUUUGGUACCG---------GCAUGCAAAGGUUCGAAUCCUUUUACUCCAG",
"CGGAAAGUAGCUUAGCUUGG--UAGAGCACUCGGUUUGGGACCGA---------GGGGUCGCAGGUUCGAAUCCUGUCUUUCCGA",
"GCCGGGGUGGGGUAGUGGCCAUCCUGG---GGGACUGUGGAUCCC----------CUGACCCGGGUUCAAUUCCCGGUCCCGGCC",
"GUAAACAUAGUUUA------AUCAAAACAUUAGAUUGUGAAUCUAA----------CAAUAGAGGCUCGAAACCUCUUGCUUACC",
"AGUAAAGUCAGCUA------AAAAAGCUUUUGGGCCCAUACCCCAA----------ACAUGUUGGUUAAACCCCUUCCUUUACUA"]

print(MTA (test))

test2= ['(((((((((.((.(...)((((.((.(.(((((.(((.((...))((...)-))(..)).))))).)))-)))((((...)))))(((((....)))...(.(..))))).)--)-))))))))).', 
 '(((((((((.((...(...((...)((.((((((.(.((((((..)(...(-((((..))).)((...(-(((...(...)))).))))))))))).)))))))....))))--)-)))))))))-', 
 '(--(((((...)...))(((-(...((((...(((......-...(..)))-)))((((...)((((..-.)))))))))...)))))(((...))...((((..))))))(--(-(...))))--', 
 '(((((....))))(((((((-((..(....).))))(((..-.))((.(((-..)(((((...)((.(.-..)))))))).)))))))))((...((((((((..).)))))--)-))((..))))', 
 '.((((...)))(...))(((-((((((.(....(((((((...))(.....-.))(.((((((..))))-((...)--))...)((-(((.-.)-))))))))))-.)).))--)))))((...))', 
 '.((((((((.((((.((.((-((...))(...)))))(((..))))(((((-......(..)))...)))))((((((((...)))--.)-----((...))(..))))))...--)))))).)).', 
 '(((...)((....).)((((-(...)).)))))((((.(((((..)(((((-.((.((...(((((((.---..))))((...))))-.))).)))))))))))).)......---)((...)))-', 
 '(((((((((((...((((((-((.((......))(..))))-))...))(((.........)).(...)-)))))))((((((.(((((((...)).)))(.(...))))))--)-)))))))))-', 
 '(((((...)))...(..)))-((...).(((((((((((...(..).(.((-(((...)))((...).)-))))))--)((((.(((-(--....)))).)))))-))))(.--.))((...))))', 
 '(((((((((((....)).))-(....((((.(.(((.((((-((((((((.-.((...))...))))))-.)((((....))))))(((...))))))...))))(...)))--)-)))))))).)', 
 '(.(((((((.((.((..((.-.........(((((((((((-(((.((((.-..)((((...))).)).-..))))))((...))))))))(...))))))))(.(...))))-)-))))))).)-', 
 '(((((((((.(..((((...-(((..))))(((((((((.(-(((((.....)))...))(...)))))-)((((((...)))))))((((...)......))))).)))))--)-)))))))))-', 
 '(((((((((.((.(((((((-(.((((....)))(((((..-.)....)).-)))....)))))).)))-(((((((...).((((.(((....)))))(...)))))))))--)-)))))))).)', 
 '(((((((((.((.(((((((-(..(((....))((((((..-.)....)).-))...)))))))).))(-((((((....)))...)))((...))...((((..).)))))--)-)))))))).)', 
 '(((((((((.((((((((((-(.((((....)))(((((..-.)....)).-)))(..)))))((...)-)))))((...)(...)))(((...))...((((..).)))))--)-))))))))).']
#'(((((((((.(.......................(...(....).........)......................(...)........((...))......(..)........).))))))))).'
#'.(((((((((....(((((((.(..(((.(((((..((.....))..)))))..)))...)))))).))..((((((..((.(((((.(((....))))))))..))))))))....)))))))))'


#for struc in test2:
#    print(parse_RNA_structure(struc))
#print(paired_acc((13,17),test2,1))"
"""